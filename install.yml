---

- hosts: all
  become: yes
  become_method: sudo
  roles:
    - geerlingguy.nodejs
    - geerlingguy.nginx
    - weareinteractive.pm2
    - shifumi.mongodb
  # shared var files
  vars_files:
    - inventory/shared/nodejs.yml
    - inventory/shared/nginx.yml
    - inventory/shared/pm2.yml
  # tasks will be executed after roles
  tasks:
    - debug:
        msg: "Nodejs {{ nodejs_version }} is ready"
    - debug:
        msg: "pm2 is ready with user {{ pm2_user }}"
    - name: "Update npm package"
      shell: npm install -g npm
